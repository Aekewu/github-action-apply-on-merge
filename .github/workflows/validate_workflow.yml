on: [push, pull-request]

jobs:

  run:
    name: Validate GorillaStack config templates
    container: hashicorp/terraform:light
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@master
    
    - name: Install GorillaStack Terraform Provider
      run: go get -d github.com/gorillastack/terraform-provider-gorillastack
    - name: Install GorillaStack Terraform Provider 1
      run: cd $GOPATH/src/github.com/gorillastack/terraform-provider-gorillastack
    - name: Install GorillaStack Terraform Provider 2
      run: make

    - name: Initialize the Provider/templates
      run: terraform init

    - name: Validate Terraform templates
      run: terraform validate
